<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="../../favicon.ico" type="image/x-icon">
  <title>Process</title>
  <style>
    @font-face {
      font-family: 'press2p';
      font-style: normal;
      font-weight: 400;
      src: url('../../media/f8c7d4a04eee4eea-s.p.ttf') format('truetype');
    }
    @font-face {
      font-family: 'dmo';
      font-style: normal;
      font-weight: 400;
      src: url('../../media/DungGeunMo.ttf') format('truetype');
    }

@media screen and (max-width: 1920px) {
  .box {
    transform: scale(0.8);
  }
}

    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      background-color: black;
      display: flex;
      justify-content: center;
      align-items: center;
      font-family: monospace;
      color: white;
    }

    div {
      font-family: 'press2p';
    }

    .dmo-text {
  font-family: 'dmo';
  font-size: 32px;
}

    .box {
      width: 1200px;
      height: 900px;
      padding: 20px;
      border: 2px solid white;
      position: relative;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .box::before {
      content: '';
      position: absolute;
      inset: 0;
      background: url('https://l3u8e64e5j.ufs.sh/f/screenw.webp') center/cover no-repeat;
      filter: brightness(40%);
      z-index: 0;
    }

    .box > * {
      position: relative;
      z-index: 1;
    }

.header-info {
  display: flex;
  align-items: center;
  padding: 10px 15px;
  border-bottom: 2px solid white;
  height: 87px; /* 통일된 높이로 지정 */
  box-sizing: border-box;
}

    .user-photo {
      width: 50px;
      height: 50px;
      background: url('../../media/login/login_door.png') center/cover no-repeat;
      border: 2px solid white;
      margin-right: 10px;
    }

    .user-text {
      display: flex;
      flex-direction: column;
      justify-content: center;
      height: 50px;
    }

    .user-text div {
      line-height: 1.2;
    }

.main-content {
  flex-grow: 1;
  display: flex;
  flex-direction: column;
  padding: 15px;
}

.inner-box {
  flex-grow: 1;
  display: flex;
  flex-direction: column;
  border: 1px solid white;
  background-color: rgba(0, 0, 0, 0.6);
}

    .title-bar {
      height: 30px;
      border-bottom: 1px solid white;
      display: flex;
      align-items: center;
      padding: 0 15px;
      user-select: none;
      background-color: white;
      color: black;
    }

    .title-buttons {
      margin-left: auto;
      display: flex;
      gap: 8px;
    }

    .title-button {
      width: 14px;
      height: 14px;
      border: 1px solid white;
      background-color: #222;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 12px;
      color: white;
      font-weight: bold;
    }

    .title-button:hover {
      background-color: white;
      color: black;
    }

    .title-button.exit {
      text-decoration: none;
      color: white;
    }

    .content-box {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
    }
.footer {
  height: 40px;
  border-top: 2px solid white;
  display: flex;
  align-items: center;
  justify-content: flex-start;
  padding: 0 15px;
}
    .footer a {
      color: white;
      text-decoration: none;
      font-size: 14px;
    }

    .footer a:hover {
      text-decoration: underline;
      color: black;
      text-shadow:
        -1px -1px 0 white,
        1px -1px 0 white,
        -1px 1px 0 white,
        1px 1px 0 white;
    }

 .top-button {
    padding: 10px 20px;
    background-color: black;
    color: white;
    border: 2px solid white;
    font-family: 'dmo';
    font-size: 22px;
    cursor: pointer;
    width: 150px;
  }

  .top-button:hover {
    background-color: white;
    color: black;
  }

  .custom-button {
    padding: 6px 14px;
    background-color: black;
    color: white;
    border: 2px solid white;
    font-family: 'dmo';
    font-size: 18px;
    cursor: pointer;
    width: 150px;
  }

  .custom-button:hover {
    background-color: white;
    color: black;
  }

.option-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  height: 50px;
  border-bottom: 1px solid white;
  font-family: 'dmo';
  font-size: 14px;
  padding: 0 10px;
}

.optionname {
  font-family: 'dmo';
  flex: 1;
  font-size: 16px;
}

.option-value {
  flex: 1;
  color: #b4b4b4;
  text-align: center;
}

.option-value.only {
  font-family: 'dmo';
  color: #cccccc;
  font-size: 20px;
  flex: 2;
  text-align: right;
}

 .right-tab {
    flex: 1;
    padding: 20px;
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 20px;
  }

  .right-tab img {
    width: 400px;
    height: auto;
  }

  .right-tab .info-text {
    color: white;
    font-family: 'dmo';
    text-align: center;
    font-size: 18px;
    margin-bottom: 30px;
  }

  .right-tab .action-button {
    width: 230px;
    padding: 15px 10px;
    font-family: 'dmo';
    font-size: 20px;
    background-color: black;
    color: white;
    border: 2px solid white;
    cursor: pointer;
  }

  .right-tab .action-button:hover {
    background-color: white;
    color: black;
  }

  .help-button {
    position: absolute;
    top: 10px;
    right: 10px;
    width: 20px;
    height: 20px;
    font-family: 'dmo';
    background-color: black;
    color: white;
    border: 2px solid white;
    font-size: 14px;
    cursor: pointer;
    line-height: 16px;
    text-align: center;
    padding: 0;
  }

  .help-button:hover {
    background-color: white;
    color: black;
  }

  .modal-close-button {
  padding: 10px 20px;
  background-color: black;
  color: white;
  border: 2px solid white;
  font-size: 22px;
  cursor: pointer;
  font-family: 'dmo';
}

.modal-close-button:hover {
  background-color: white;
  color: black;
}


#horrorOverlay, #blackScreen {
  position: fixed;
  top: 0; left: 0;
  width: 100vw;
  height: 100vh;
  z-index: 9999;
  display: none;
}

#horrorOverlay {
  background: url('./Moduleoff.gif') center/cover no-repeat;
  opacity: 0.65;
}

#blackScreen {
  background: black;
  z-index: 10000; /* 더 위에 오도록 */
}

  </style>

</head>
<body>
  <div class="box">
    <div class="header-info">
      <div class="user-photo"></div>
      <div class="user-text">
        <div>Adrift02</div>
        <div>root: - access</div>
      </div>
    </div>

    <div class="main-content">
      <div class="inner-box">
        <div class="title-bar">
          <div>PASTCORE SYSTEM</div>
          <div class="title-buttons">
            <div class="title-button">−</div>
            <div class="title-button">□</div>
            <a href="../process.html" class="title-button exit">×</a>
          </div>
        </div>

<div class="content-box">
  <div class="top-section" style="flex: 0 0 200px;; display: flex; border-bottom: 1px solid white;">
    <!-- 방화벽 모듈 -->
    <div style="flex: 1; border-right: 1px solid white; padding: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center;">
      <div class="dmo-text" style="margin-bottom: 10px;">방화벽 모듈</div>
      <button class="top-button">On</button>
    </div>
    
    <!-- 관측분기제어 -->
    <div style="flex: 1; border-right: 1px solid white; padding: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center;">
      <div class="dmo-text" style="margin-bottom: 10px;">관측분기제어</div>
      <button class="top-button">연결차단</button>
    </div>
    
    <!-- 근미래 세션 접속 -->
    <div style="flex: 1; padding: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center;">
      <div class="dmo-text" style="margin-bottom: 10px;">근미래 세션 접속</div>
      <button class="top-button">접속시도</button>
    </div>
  </div>

<div class="bottom-section" style="flex: 1; padding: 0; display: flex; flex-direction: column; border-top: 1px solid white;">
  <!-- 타이틀 바 -->
  <div class="title-bar">
    User Option
  </div>
  

  <!-- 본문 내용: 좌/우로 나눔 -->
  <div style="flex: 1; display: flex;">

    <!-- 왼쪽 사용자 설정 파트 -->
    <div style="flex: 1; border-right: 1px solid white; padding: 20px; display: flex; flex-direction: column; font-family: 'dmo'; font-size: 14px;">

<!-- 사용자 설정 항목 영역 내부 -->
<div class="option-row">
  <div class="optionname">사용자 이름</div>
  <div class="option-value">Adrift02</div>
  <button class="custom-button">NameChange</button>
</div>

<div class="option-row">
  <div class="optionname">비밀번호</div>
  <div class="option-value">N*********</div>
  <button class="custom-button">PasswdChange</button>
</div>

<div class="option-row">
  <div class="optionname">세션 미승인 여부</div>
  <div class="option-value only">승인됨</div>
</div>

<div class="option-row">
  <div class="optionname">현상고정대 여부</div>
  <div class="option-value only">고정되지 않음</div>
</div>

<div class="option-row">
  <div class="optionname">네트워크 제한</div>
  <div class="option-value only">한시적 제한</div>
</div>

<div class="option-row">
  <div class="optionname">사용 중인 기기</div>
  <div class="option-value only">COMPUTERㆍFUTURE</div>
</div>

<div class="option-row">
  <div class="optionname">차단 내역</div>
  <div class="option-value only">NO</div>
</div>

<div class="option-row">
  <div class="optionname">전체 데이터 및 로그</div>
  <button class="custom-button">SHOW ALL</button>
</div>

    </div>
    <div style="flex: 1;">

<div class="right-tab">

  <!-- 도움말 버튼 -->
  <button class="help-button">?</button>

  <!-- 로고 이미지 -->
  <img src="../../media/img/pastcorelogo.png" alt="logo" />

  <!-- 설명 텍스트 -->
  <div class="info-text">
    이 영역은 시스템 정보 및 기능 도구를 포함합니다.<br>
    모든 기능은 제한된 세션에서만 사용 가능합니다.
  </div>

  <!-- 버튼들 -->
  <button class="action-button">무결성 검사</button>
  <button class="action-button">개발자 모드</button>

</div>

    </div>
        </div>
  </div>
</div>


</div>
  </div>
      <div class="footer">
      <a href="../process.html">&lt; back</a>
    </div>

<div id="passwordModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.6); z-index: 9999; justify-content: center; align-items: center;">
  <div style="background-color: black; border: 2px solid white; padding: 30px 40px; font-family: 'dmo'; color: white; display: flex; flex-direction: column; align-items: center; gap: 20px;">
    <div id="modalText" style="font-family: 'dmo'; font-size: 22px;">현재 비밀번호를 입력해주십시오.</div>
    <input type="password" id="modalInput" style="width: 250px; padding: 8px; font-size: 16px; font-family: 'dmo'; background-color: black; border: 2px solid white; color: white;">
  </div>
</div>

<!-- 경고창 -->
<div id="errorPopup" style="
  display: none;
  position: absolute;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  background-color: black;
  padding: 40px 80px;
  border: 2px solid rgb(255, 255, 255);
  color: rgb(255, 255, 255);
  font-size: 36px;
  font-family: 'press2p', monospace;
  z-index: 9999;
  text-align: center;
">
  Wrong Password
</div>

<!-- 무결성 검사 모달 -->
<div id="integrityModal" style="
  display: none;
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background-color: rgba(0,0,0,0.8);
  z-index: 10000;
  justify-content: center;
  align-items: center;
  font-family: 'dmo';
">
  <div style="
    background-color: black;
    border: 2px solid white;
    padding: 40px 50px;
    text-align: center;
    color: white;
    display: flex;
    flex-direction: column;
    gap: 20px;
    min-width: 500px;
  ">
    <div style="font-size: 22px; font-family: 'dmo';">무결성 검사 진행 중</div>
    <div style="width: 100%; height: 28px; border: 1px solid white; background-color: #111;">
      <div id="progressBar" style="height: 100%; width: 0%; background-color: white;"></div>
    </div>
    <div id="progressText" style="font-size: 18px;">[0/30203]</div>
  </div>
</div>

<!-- 도움말 모달 -->
<div id="helpModal" style="
  display: none;
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background-color: rgba(0, 0, 0, 0.8);
  z-index: 10000;
  justify-content: center;
  align-items: center;
  font-family: 'dmo';
">
  <div style="
    background-color: black;
    border: 2px solid white;
    padding: 40px 50px;
    text-align: center;
    color: white;
    display: flex;
    flex-direction: column;
    gap: 20px;
    min-width: 400px;
  ">
    <div style="font-family: 'dmo'; font-size: 20px;">
      시스템 동작에 대한 간략한 안내입니다.<br>세션 상태에 따라 기능 이용이 제한될 수 있습니다.
    </div>
      <button id="closeHelpModal" class="modal-close-button">닫기</button>
  </div>
</div>


<!-- 접속 시도 모달 -->
<div id="connectionModal" style="
  display: none;
  position: fixed; top: 0; left: 0;
  width: 100%; height: 100%;
  background-color: rgba(0,0,0,0.8);
  z-index: 10001;
  justify-content: center; align-items: center;
  flex-direction: column;
  color: white;
  font-family: 'dmo';
  font-size: 22px;
">
  <div style="font-size: 30px; font-family: 'press2p';">Connecting...</div>
  <img src="https://i.gifer.com/ZZ5H.gif" alt="로딩중" style="width: 80px; height: 80px; margin: 20px 0;">
</div>

<!-- 접속 실패 모달 -->
<div id="connectionFailModal" style="
  display: none;
  position: fixed; top: 0; left: 0;
  width: 100%; height: 100%;
  background-color: rgba(0,0,0,0.8);
  z-index: 10002;
  justify-content: center; align-items: center;
  flex-direction: column;
  color: white;
  font-family: 'dmo';
  font-size: 26px;
">
  <div style="font-size: 30px; font-family: 'press2p';">Connection Failed</div>
  <button id="closeConnectionFail" class="modal-close-button" style="margin-top: 20px; width: 120px;">닫기</button>
</div>



<div id="confirmConnectionModal" style="
  display: none;
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background-color: rgba(0,0,0,0.8);
  z-index: 10001;
  justify-content: center; align-items: center;
  flex-direction: column;
  color: white;
  font-family: 'dmo';
  font-size: 22px;
">
  <div style="font-size: 30px; font-family: 'dmo'; margin-bottom: 20px; text-align: center;">현재 <i>'23세기'</i>에 가까운 세션에서 진행되고 있습니다.<br> 지금보다 미래의 세션에 접속할 경우 인류가 아닌 존재와 상호 접촉이 있을 수 있습니다.<br> 접속하시겠습니까?</div>
  <button id="confirmConnectBtn" class="modal-close-button" style="width: 150px;">Connect</button>
</div>


<!-- 방화벽 모듈 중단 확인 모달 -->
<div id="firewallConfirmModal" style="
  display: none;
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background-color: rgba(0,0,0,0.8);
  z-index: 10002;
  justify-content: center; align-items: center;
  font-family: 'dmo';
  color: white;
">
  <div style="
    background-color: black;
    border: 2px solid white;
    padding: 40px 50px;
    text-align: center;
    display: flex;
    flex-direction: column;
    gap: 20px;
    min-width: 400px;
  ">
    <div style="font-family: 'dmo'; font-size: 22px;">정말 방화벽 모듈을 중단하시겠습니까?</div>
    <button id="deactivateFirewallBtn" class="modal-close-button">모듈 중단</button>
  </div>
</div>

<!-- 괴기한 연출용 배경과 사운드 -->
<div id="horrorOverlay"></div>
<div id="blackScreen"></div>

<audio id="horrorSound" src="./Moduleoff.mp3"></audio>

<!-- 방화벽 재가동 모달 -->
<div id="firewallRestartedModal" style="
  display: none;
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background-color: rgba(0, 0, 0, 0.9);
  z-index: 10004;
  justify-content: center; align-items: center;
  font-family: 'dmo';
  color: white;
">
  <div style="
    background-color: black;
    border: 2px solid white;
    padding: 30px 50px;
    font-size: 24px;
    font-family: 'dmo';
  ">
    방화벽 모듈이 재가동 되었습니다.
  </div>
</div>



<!-- 방화벽 재가동 모달 -->
<div id="systemsys" style="
  display: none;
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background-color: rgba(0, 0, 0, 0.9);
  z-index: 10004;
  justify-content: center; align-items: center;
  font-family: 'dmo';
  color: white;
">
  <div style="
    background-color: black;
    border: 2px solid white;
    padding: 30px 50px;
    font-size: 24px;
    font-family: 'dmo';
  ">
    연결 차단을 할 수 없습니다.
  </div>
</div>



<script>
  const modal = document.getElementById('passwordModal');
  const modalText = document.getElementById('modalText');
  const modalInput = document.getElementById('modalInput');
  const errorPopup = document.getElementById('errorPopup');

  // 공통으로 사용할 모달 오픈 함수
  function openPasswordModal(text) {
    modalText.innerText = text;
    modal.style.display = 'flex';
    modalInput.value = '';
    modalInput.focus();
  }

  // 엔터 입력 시: 무조건 틀림 처리
  modalInput.addEventListener('keydown', function(e) {
    if (e.key === 'Enter') {
      modal.style.display = 'none';
      errorPopup.style.display = 'block';
      setTimeout(() => {
        errorPopup.style.display = 'none';
      }, 2000);
    }
  });

  // 버튼들 연결
  document.querySelectorAll('.custom-button').forEach(button => {
    button.addEventListener('click', () => {
      openPasswordModal('현재 비밀번호를 입력해주십시오.');
    });
  });

  document.querySelectorAll('.action-button').forEach(button => {
    if (button.innerText.trim() === '개발자 모드') {
      button.addEventListener('click', () => {
        openPasswordModal('관리자 권한 비밀번호를 입력하십시오.');
      });
    }
  });


const integrityModal = document.getElementById('integrityModal');
const progressBar = document.getElementById('progressBar');
const progressText = document.getElementById('progressText');

function openIntegrityCheck() {
  integrityModal.style.display = 'flex';
  let count = 0;
  const max = 3203;

  function updateProgress() {
    if (count >= max) {
      setTimeout(() => {
        integrityModal.style.display = 'none';
      }, 1000);
      return;
    }

    // 다음 증가량: 1~Math.min(500, 남은 갯수)
    const increment = Math.floor(Math.random() * 50) + 1;
    count = Math.min(count + increment, max);

    const percent = (count / max) * 100;
    progressBar.style.width = percent + '%';
    progressText.innerText = `[${count}/${max}]`;

    // 랜덤 딜레이: 10~60ms
    const delay = Math.floor(Math.random() * 50) + 10;
    setTimeout(updateProgress, delay);
  }

  updateProgress();
}

document.querySelectorAll('.action-button').forEach(button => {
  if (button.innerText.trim() === '무결성 검사') {
    button.addEventListener('click', () => {
      openIntegrityCheck();
    });
  }
});


const helpModal = document.getElementById('helpModal');
const helpButton = document.querySelector('.help-button');
const closeHelpModal = document.getElementById('closeHelpModal');

// 도움말 열기
helpButton.addEventListener('click', () => {
  helpModal.style.display = 'flex';
});

// 닫기 버튼
closeHelpModal.addEventListener('click', () => {
  helpModal.style.display = 'none';
});


const connectButton = document.querySelectorAll('button.top-button')[2];
const confirmConnectionModal = document.getElementById('confirmConnectionModal');
const confirmConnectBtn = document.getElementById('confirmConnectBtn');
const connectionModal = document.getElementById('connectionModal');
const connectionFailModal = document.getElementById('connectionFailModal');
const closeConnectionFail = document.getElementById('closeConnectionFail');

// 저장된 접속 시도 횟수 불러오기 (없으면 0)
let connectionAttempts = parseInt(localStorage.getItem('connectionAttempts')) || 0;

// 접속 시도 버튼 클릭 시 → "진짜 접속하시겠습니까?" 모달 표시
connectButton.addEventListener('click', () => {
  confirmConnectionModal.style.display = 'flex';
});

// Connect 버튼 클릭 시 → Connecting... 모달 → 실패 및 메시지 출력
confirmConnectBtn.addEventListener('click', () => {
  confirmConnectionModal.style.display = 'none';
  connectionModal.style.display = 'flex';

  setTimeout(() => {
    connectionModal.style.display = 'none';
    connectionFailModal.style.display = 'flex';

    connectionAttempts++;
    localStorage.setItem('connectionAttempts', connectionAttempts); // 저장

    let message = '';

    switch (connectionAttempts) {
      case 1:
        message = '(한국어 번역됨)\n그만두는게 좋을걸세.\n이 이상의 미래는 온전치 못할 수도 있다네. 미래인 군.\n- This message was sent in 2026';
        break;
      case 2:
        message = '(한국어 번역됨)\n자네의 세계선에선 근미래 세션 접속따윈 안하는게 좋아.\n자네도 알고있겠지?\n- This message was sent in 2026';
        break;
      case 3:
        message = '(한국어 번역됨)\n12년 전에 접속했던, 자네 세계선의 자아체가 있었는데\n근미래 세션 접속 이후로 보이지 않고 있지.\n- This message was sent in 2026';
        break;
      case 4:
        message = '(한국어 번역됨)\n상당히 흥미로운 주제지만 호기심은 존재를 죽이는 법.\n자네 또한 몸 사리는게 좋을걸세. 비록 얼마 남지 않았다 하더라도.\n- This message was sent in 2026';
        break;
      case 5:
        message = '(한국어 번역됨)\n흐름은 재앙이지만, 비약 또한 절망이라는 걸 알고있게나.\n근미래 세션 접속 모듈은 차단해놓겠네.\n- This message was sent in 2026';
        break;
      default:
        message = 'This connection has been blocked by the module.\n Please Again Later.';
        break;
    }

    alert(message);
  }, 4000);
});

// "닫기" 버튼 클릭 시 실패 모달 닫기
closeConnectionFail.addEventListener('click', () => {
  connectionFailModal.style.display = 'none';
});


const firewallButton = document.querySelectorAll('.top-button')[0]; // 첫 번째 버튼
const firewallConfirmModal = document.getElementById('firewallConfirmModal');
const deactivateFirewallBtn = document.getElementById('deactivateFirewallBtn');
const horrorOverlay = document.getElementById('horrorOverlay');
const horrorSound = document.getElementById('horrorSound');
const firewallRestartedModal = document.getElementById('firewallRestartedModal');

// 1. On 버튼 클릭 → 확인 모달
firewallButton.addEventListener('click', () => {
  firewallConfirmModal.style.display = 'flex';
});

// 2. '모듈 중단' 버튼 클릭 시 괴기 연출
deactivateFirewallBtn.addEventListener('click', () => {
  firewallConfirmModal.style.display = 'none';

  // glitch 이미지 보여주기
  horrorOverlay.style.display = 'block';
  blackScreen.style.display = 'none'; // 초기화

  horrorSound.currentTime = 0;
  horrorSound.play();

  // 8초 후 → 검은 화면 덮기
  setTimeout(() => {
    blackScreen.style.display = 'block';
  }, 8000);

  // 10초 후 → 모두 해제 + 모달 띄우기
  setTimeout(() => {
    horrorOverlay.style.display = 'none';
    blackScreen.style.display = 'none';
    firewallRestartedModal.style.display = 'flex';

    setTimeout(() => {
      firewallRestartedModal.style.display = 'none';
    }, 3000);
  }, 10000);
});



const terminalContainer = document.querySelector('.content-box');
const inputLine = { style: { display: 'none' } }; // inputLine 숨김 처리 용 (실제로 없으면 빈 객체로 대체)
const userInput = { focus: () => {} }; // userInput 포커스 함수 빈 구현

const connectBlockButton = document.querySelectorAll('.top-button')[1]; // 연결차단 버튼

connectBlockButton.addEventListener('click', () => {
  glitchWholeTerminal(() => {
    restoreTerminalAfterGlitch(() => {
          systemsys.style.display = 'flex';

    setTimeout(() => {
      systemsys.style.display = 'none';
    }, 3000);
    });
  });
});



function glitchWholeTerminal(callback) {
  inputLine.style.display = 'none';
  document.body.style.overflow = 'hidden';
  document.documentElement.style.overflow = 'hidden';

  const rect = terminalContainer.getBoundingClientRect();

  const glitchContainer = document.createElement('div');
  glitchContainer.id = 'glitch-container';
  glitchContainer.style.position = 'absolute';
  glitchContainer.style.top = `${rect.top + window.scrollY}px`;
  glitchContainer.style.left = `${rect.left + window.scrollX}px`;
  glitchContainer.style.width = `${rect.width}px`;
  glitchContainer.style.height = `${rect.height}px`;
  glitchContainer.style.overflow = 'visible';
  glitchContainer.style.pointerEvents = 'none';
  glitchContainer.style.zIndex = '9999';
  document.body.appendChild(glitchContainer);

  const rows = 6, cols = 12;
  const pieceWidth = rect.width / cols;
  const pieceHeight = rect.height / rows;

  const terminalClone = terminalContainer.cloneNode(true);
  terminalClone.id = 'terminal-clone';
  terminalClone.style.position = 'fixed';
  terminalClone.style.top = `${rect.top}px`;
  terminalClone.style.left = `${rect.left}px`;
  terminalClone.style.margin = '0';
  terminalClone.style.pointerEvents = 'none';
  terminalClone.style.userSelect = 'none';
  terminalClone.style.width = `${rect.width}px`;
  terminalClone.style.height = `${rect.height}px`;
  terminalClone.style.overflow = 'visible';
  terminalClone.style.zIndex = '10000';
  terminalClone.style.filter = 'grayscale(100%)';
  document.body.appendChild(terminalClone);

  for (let r = 0; r < rows; r++) {
    for (let c = 0; c < cols; c++) {
      const piece = document.createElement('div');
      piece.style.position = 'absolute';
      piece.style.width = `${pieceWidth}px`;
      piece.style.height = `${pieceHeight}px`;
      piece.style.overflow = 'hidden';
      piece.style.top = `${r * pieceHeight}px`;
      piece.style.left = `${c * pieceWidth}px`;
      piece.style.backgroundColor = 'black';

      const innerClone = terminalClone.cloneNode(true);
      innerClone.style.position = 'absolute';
      innerClone.style.top = `-${r * pieceHeight}px`;
      innerClone.style.left = `-${c * pieceWidth}px`;
      innerClone.style.width = `${rect.width}px`;
      innerClone.style.height = `${rect.height}px`;
      innerClone.style.pointerEvents = 'none';
      innerClone.style.userSelect = 'none';

      piece.appendChild(innerClone);
      glitchContainer.appendChild(piece);

      const offsetX = (Math.random() - 0.5) * rect.width * 0.8;
      const offsetY = (Math.random() - 0.5) * rect.height * 0.8;
      piece.style.transform = `translate(${offsetX}px, ${offsetY}px)`;
    }
  }

  terminalContainer.style.visibility = 'hidden';

  // ✅ 글리치 연출을 500ms 보여준 뒤 검은 화면 덮기
  setTimeout(() => {
    const blackOverlay = document.createElement('div');
    blackOverlay.id = 'black-overlay';
    blackOverlay.style.position = 'fixed';
    blackOverlay.style.top = '0';
    blackOverlay.style.left = '0';
    blackOverlay.style.width = '100vw';
    blackOverlay.style.height = '100vh';
    blackOverlay.style.backgroundColor = 'black';
    blackOverlay.style.zIndex = '11000';
    document.body.appendChild(blackOverlay);

    if (callback) callback();
  }, 1000); // 글리치 화면 보여주는 시간
}


function restoreTerminalAfterGlitch(callback) {
  const glitchContainer = document.getElementById('glitch-container');
  if (glitchContainer) glitchContainer.remove();

  const terminalClone = document.getElementById('terminal-clone');
  if (terminalClone) terminalClone.remove();

  // 검은 화면 이미 덮여 있으므로 3초 후 복원만 수행
  setTimeout(() => {
    const blackOverlay = document.getElementById('black-overlay');
    if (blackOverlay) blackOverlay.remove();

    terminalContainer.style.visibility = 'visible';
    inputLine.style.display = 'flex';
    userInput.focus();

    document.body.style.overflow = '';
    document.documentElement.style.overflow = '';

    if (callback) callback();
  }, 3000);
}




</script>

</body>
</html>